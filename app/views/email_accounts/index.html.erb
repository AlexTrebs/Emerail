<div class="accounts-header">
  <h1>Email Accounts</h1>
  <%= link_to "Add New Account", new_email_account_path, class: "btn btn-primary" %>
</div>

<% if @accounts.any? %>
  <div class="accounts-list">
    <% @accounts.each do |account| %>
      <div class="account-card">
        <div class="account-info">
          <div class="account-username">
            <span class="email-account-badge" style="background-color: <%= account_color(account) %>">
              <%= account.username %>
            </span>
          </div>
          <div class="account-details">
            <span class="detail-item">
              Provider: <strong><%= account.provider.titleize %></strong>
            </span>
            <% if account.imap? %>
              <span class="detail-item">
                Server: <strong><%= account.imap_host %>:<%= account.imap_port %></strong>
              </span>
            <% end %>
            <span class="detail-item">
              Messages: <strong><%= account.email_messages.count %></strong>
            </span>
            <span class="detail-item">
              Last synced: <strong><%= account.last_synced_at ? time_ago_in_words(account.last_synced_at) + " ago" : "Never" %></strong>
            </span>
          </div>
        </div>
        <div class="account-actions">
          <%= button_to "Sync Now", sync_email_account_path(account), method: :post, class: "btn btn-primary", data: { turbo: false } %>
          <%= button_to "Remove", email_account_path(account), method: :delete, class: "btn btn-danger", 
              data: { turbo_confirm: "Are you sure? This will also delete all emails from this account." } %>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <div class="empty-state">
    <h2>No email accounts yet</h2>
    <p>Add your first email account to start aggregating your emails.</p>
    <%= link_to "Add Email Account", new_email_account_path, class: "btn btn-primary" %>
  </div>
<% end %>
